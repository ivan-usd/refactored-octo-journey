---
title: "HW 6 Notebook"
output: html_notebook
---
#### Importing Data Science Package via Tidyverse
```{r}
library(tidyverse)
library(cluster)
library(ape)
```

#### Importing LPGA 2008 dataframe
```{r}
lpgaFP = 'Data/lpga2008.csv'
df = read.table(file = lpgaFP, sep = ',', header = TRUE)
```

```{r}
sum(is.na(df))
```


```{r}
summary(df)
```



#### Use agglomerative clustering and divisive clustering on this dataset to find out which players have similar performance in the same season. Visualize the clusters using dendrograms for both types of clustering models. (20 points)

```{r}
df = na.omit(df)
head(df)
```

```{r}
df = df %>%
      mutate_if(is.numeric,scale)

```

```{r}
head(df)
```

#### Finding the method that yileds the strongest clustering structure. The values closest to 1 signifies a strong cluster, that method was ward.

```{r}
# methods to assess
m <- c( "average", "single", "complete", "ward")
names(m) <- c( "average", "single", "complete", "ward")

# function to compute coefficient
ac <- function(x) {
  agnes(df, method = x)$ac
}
map_dbl(m, ac)
```

#### Used agnes function to get the agglomerative cluster (bottom-up mode), then graphed using pltree.


```{r}
aggCluster = agnes(df, method = "ward")

pltree(aggCluster, cex = .25, hang = -1, main = "Dendrogram of agnes")
```

#### Used diana funtion to get the divisive cluster (top-down mode).


```{r}
divCluster = diana(df)
divCluster$dc
```


```{r}
pltree(divCluster, cex = 0.25, hang = -1, main = "Dendrogram of diana")
```

#### As can be seen from the different approaches there seems to be alot more clusters in the agglomerative cluster as should be expected since it makes most of it pairings at the initial variables (bottom-up approach). As for the Divisive Cluster there appears to be alot more symmetery and less clustering near the bottom.

